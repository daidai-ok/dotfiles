# dotfiles

MacOS 開発環境の設定ファイル集。

## ディレクトリ構造

```
dotfiles/
├── README.md
├── ghostty/
│   └── config         # Ghosttyターミナル設定
├── starship/
│   └── starship.toml  # Starshipプロンプト設定
├── tmux/
│   └── tmux.conf      # tmux設定ファイル
├── vimrc/
│   ├── .vimrc         # Vimメイン設定
│   ├── appearance.vimrc  # Vim外観設定
│   └── basic.vimrc    # Vim基本設定
└── claude-skills/     # Claude Code用カスタムスキル
```

## セットアップ

### Ghostty

Ghosttyはシンボリックリンク経由だと設定ファイルを正しく読み込めないため、デフォルトの設定ファイルに直接コピーして上書きする：

```bash
mkdir -p ~/.config/ghostty && cp ~/dotfiles/ghostty/config ~/.config/ghostty/config
```

設定を変更した場合は再度コピーを実行して反映する。

### tmux

シンボリックリンクだと `source-file` 時にパス解決の問題で設定が正しくロードされない場合があるため、直接コピーする：

```bash
cp ~/dotfiles/tmux/tmux.conf ~/.tmux.conf
```

設定を変更した場合は再度コピーを実行して反映する。既存セッション内では `Ctrl-a r` で設定をリロードできる。

### Starship

Starshipプロンプトの設定ファイルをシンボリックリンクで配置：

```bash
mkdir -p ~/.config && ln -sf ~/dotfiles/starship/starship.toml ~/.config/starship.toml
```

## 詳細

### tmux

Claude Codeでの同時並列開発に最適化したtmux設定。複数のClaude Codeインスタンスをセッション単位で管理し、効率的に切り替えながら並行作業を行うことを想定している。

#### デフォルト起動レイアウト

tmux起動時に自動で4ペインが田の字型に立ち上がる。最初の2ペインには名前が付与され、ペインボーダー上部に表示される。

```
┌─── claude ───┬── operation ──┐
│              │               │
│              │               │
├──── ─ ───────┼───── ─ ───────┤
│              │               │
│              │               │
└──────────────┴───────────────┘
```

| ペイン | 名前 | 用途の想定 |
|--------|------|------------|
| 1 (左上) | claude | Claude Code実行用 |
| 2 (右上) | operation | 手動操作・確認用 |
| 3 (左下) | (なし) | 自由 |
| 4 (右下) | (なし) | 自由 |

この自動レイアウトはtmux初回起動時のみ実行される（セッション・ウィンドウ・ペインがすべて1つの場合）。設定リロードや `prefix + C` での新規セッション作成時には実行されない。

#### 基本設定

| 項目 | 設定値 |
|------|--------|
| prefix キー | `Ctrl-a`（デフォルトの`Ctrl-b`から変更） |
| マウス操作 | 有効（ペイン選択・リサイズ・スクロール） |
| カラー | トゥルーカラー（Ghostty連携） |
| ステータスバー | 画面上部に表示 |
| ペイン/ウィンドウ番号 | 1始まり |
| スクロールバッファ | 50,000行 |
| Escキー遅延 | 0ms |
| コピーモード | vi キーバインド、`y` でmacOSクリップボードにコピー |
| テーマ | GhosttyのRyuukoカラーパレットに準拠 |

#### キーバインド一覧

すべてのキーバインドは `prefix`（`Ctrl-a`）を押してから操作する。

##### ペイン操作

| キー | 動作 |
|------|------|
| `v` / `\|` | 左右に分割 |
| `-` | 上下に分割 |
| `h` / `j` / `k` / `l` | ペイン移動（Vim風: 左/下/上/右） |
| 矢印キー | ペイン移動 |
| `H` / `J` / `K` / `L` | ペインリサイズ（5セルずつ、連打可） |
| `z` | ペインをズーム（全画面化/戻す） |
| `x` | ペインを閉じる |

##### セッション管理

| キー | 動作 |
|------|------|
| `C` | claude-N セッションを自動作成（連番） |
| `s` | セッション一覧をツリー表示 |
| `S` | セッション名を入力して切り替え |
| `f` | fzfでセッション選択（要 `brew install fzf`） |
| `Tab` | 直前のセッションに戻る |
| `(` / `)` | 前/次のセッション |
| `N` | セッション名をclaude-Nにリネーム |
| `$` | セッション名を変更 |

##### レイアウトプリセット

GhosttyでOptionキーをAlt(Meta)として送信する設定が必要（`macos-option-as-alt`）。

| キー | 動作 |
|------|------|
| `Option+1` | 2ペイン横並び |
| `Option+2` | 3ペイン（メイン + 右上下） |
| `Option+3` | 4ペイン均等タイル |
| `Option+4` | 全ペイン横並び均等 |
| `Option+5` | 全ペイン縦並び均等 |
| `E` | タイル状に再整列 |

##### 便利機能

| キー | 動作 |
|------|------|
| `y` | 全ペイン同時入力 ON/OFF |
| `g` | ポップアップシェル（Escで閉じる） |
| `m` / `M` | ペインをマーク / マークしたペインと入れ替え |
| `B` | ペインを別ウィンドウに分離 |
| `@` | 他ウィンドウのペインを結合 |

##### ウィンドウ

| キー | 動作 |
|------|------|
| `c` | 新規ウィンドウ |
| `n` / `p` | 次/前のウィンドウ |
| `1`〜`9` | ウィンドウ番号で移動 |

##### コピーモード

`prefix + [` で開始。vi操作でテキストを選択・コピーする。

| キー | 動作 |
|------|------|
| `v` | 選択開始 |
| `y` | コピー（macOSクリップボードへ） |
| `q` | コピーモード終了 |

##### その他

| キー | 動作 |
|------|------|
| `r` | 設定ファイルを再読み込み |
| `?` | 全キーバインド一覧 |

#### Claude Code並列運用の流れ

```
1. tmuxを起動（4ペインが自動作成される）
2. claudeペインでClaude Codeを起動
3. 追加のセッションが必要なら prefix + C で作成（claude-1, claude-2, ...）
4. セッション間の切り替えは prefix + f（fzf）または prefix + Tab
5. 全ペインに同じコマンドを送りたいときは prefix + y で同時入力モード
```

